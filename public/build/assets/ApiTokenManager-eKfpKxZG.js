import{T as V,b as y,r as k,d as i,o as n,a as t,e as _,w as a,u as l,n as A,f as d,g as o,F as S,h as $,t as b,c as E}from"./app-BEcxhe1F.js";import{_ as w}from"./Checkbox-Dk3jDhlP.js";import{_ as Y}from"./FormSection-DgxjtniD.js";import{_ as h}from"./InputError-CpVMfFDh.js";import{_ as I}from"./InputLabel-DJT1qPlu.js";import{_ as q}from"./TextInput-DaBpTrN_.js";const G={class:"mb-3"},J={key:0,class:""},K={class:"d-flex align-items-center"},O={class:"ms-2 text-sm text-muted"},Q={key:0,class:"alert alert-success mt-3"},R={key:0},W={class:"break-all"},X={class:"d-flex align-items-center ms-2"},Z={key:0,class:"text-sm text-muted"},ee={key:0,class:"mt-4 rounded mb-4"},se={class:"language-markup"},te={class:"text-end"},ae={class:"d-flex align-items-center"},le={class:"ms-2 text-sm text-muted"},oe={class:"text-end"},ne={class:"text-end"},ve={__name:"ApiTokenManager",props:{tokens:Array,availablePermissions:Array,defaultPermissions:Array},setup(m){const r=V({name:"",permissions:m.defaultPermissions}),p=V({permissions:[]}),B=V({}),v=y(!1),C=y(!1),P=y(null),T=y(null),f=y(!1),D=()=>{r.post(route("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{C.value=!0,r.reset()}})},F=c=>{p.permissions=c.abilities,P.value=c,v.value=!0},M=()=>{p.put(route("api-tokens.update",P.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>(P.value=null,v.value=!1)})},U=c=>{T.value=c,f.value=!0},N=()=>{B.delete(route("api-tokens.destroy",T.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>(T.value=null,f.value=!1)})};return(c,e)=>{const u=k("BButton"),j=k("BCardTitle"),H=k("BCardHeader"),L=k("BCardBody"),z=k("BCard"),x=k("BModal");return n(),i("div",null,[t(Y,{onSubmitted:D,title:"Create API Token",description:"API tokens allow third-party services to authenticate with our application on your behalf."},{form:a(()=>[o("div",G,[t(I,{for:"name",value:"Name"}),t(q,{id:"name",modelValue:l(r).name,"onUpdate:modelValue":e[0]||(e[0]=s=>l(r).name=s),type:"text",autofocus:"",class:A({"is-invalid":l(r).errors.name})},null,8,["modelValue","class"]),t(h,{message:l(r).errors.name,class:"mt-2"},null,8,["message"])]),m.availablePermissions.length>0?(n(),i("div",J,[t(I,{for:"permissions",value:"Permissions"}),(n(!0),i(S,null,$(m.availablePermissions,s=>(n(),i("div",{key:s},[o("label",K,[t(w,{checked:l(r).permissions,"onUpdate:checked":e[1]||(e[1]=g=>l(r).permissions=g),value:s},null,8,["checked","value"]),o("span",O,b(s),1)])]))),128))])):_("",!0)]),actions:a(()=>[t(u,{variant:"success w-100",type:"submit",class:A({"opacity-25":l(r).processing}),disabled:l(r).processing},{default:a(()=>e[9]||(e[9]=[d("Create")])),_:1,__:[9]},8,["class","disabled"]),l(r).recentlySuccessful?(n(),i("p",Q,"Created.")):_("",!0)]),_:1}),m.tokens.length>0?(n(),i("div",R,[t(z,{"no-body":""},{default:a(()=>[t(H,null,{default:a(()=>[t(j,null,{default:a(()=>e[10]||(e[10]=[d("Manage API Tokens")])),_:1,__:[10]}),e[11]||(e[11]=o("p",{class:"text-muted mb-0"},"You may delete any of your existing tokens if they are no longer needed.",-1))]),_:1,__:[11]}),t(L,{class:"p-4"},{default:a(()=>[(n(!0),i(S,null,$(m.tokens,s=>(n(),i("div",{key:s.id,class:"d-flex align-items-center justify-content-between mb-2"},[o("div",W,b(s.name),1),o("div",X,[s.last_used_ago?(n(),i("div",Z," Last used "+b(s.last_used_ago),1)):_("",!0),m.availablePermissions.length>0?(n(),E(u,{key:1,variant:"info",class:"btn-sm me-1",onClick:g=>F(s)},{default:a(()=>e[12]||(e[12]=[d(" Permissions ")])),_:2,__:[12]},1032,["onClick"])):_("",!0),t(u,{variant:"danger",class:"btn-sm",onClick:g=>U(s)},{default:a(()=>e[13]||(e[13]=[d(" Delete ")])),_:2,__:[13]},1032,["onClick"])])]))),128))]),_:1})]),_:1})])):_("",!0),t(x,{modelValue:C.value,"onUpdate:modelValue":e[3]||(e[3]=s=>C.value=s),title:"API Token","hide-footer":"","header-class":"bg-success-subtle p-3"},{default:a(()=>[e[15]||(e[15]=o("p",{class:"fs-14 text-muted"},"Please copy your new API token. For your security, it won't be shown again.",-1)),c.$page.props.jetstream.flash.token?(n(),i("div",ee,[o("pre",se,[o("code",null,b(c.$page.props.jetstream.flash.token),1)])])):_("",!0),o("div",te,[t(u,{variant:"danger",onClick:e[2]||(e[2]=s=>C.value=!1)},{default:a(()=>e[14]||(e[14]=[d("Cancel")])),_:1,__:[14]})])]),_:1,__:[15]},8,["modelValue"]),t(x,{modelValue:v.value,"onUpdate:modelValue":e[6]||(e[6]=s=>v.value=s),title:"API Token Permissions","hide-footer":""},{default:a(()=>[(n(!0),i(S,null,$(m.availablePermissions,s=>(n(),i("div",{key:s},[o("label",ae,[t(w,{checked:l(p).permissions,"onUpdate:checked":e[4]||(e[4]=g=>l(p).permissions=g),value:s},null,8,["checked","value"]),o("span",le,b(s),1)])]))),128)),o("div",oe,[t(u,{variant:"danger",onClick:e[5]||(e[5]=s=>v.value=!v.value)},{default:a(()=>e[16]||(e[16]=[d("Cancel")])),_:1,__:[16]}),t(u,{variant:"success",class:A(["ms-1",{"opacity-25":l(p).processing}]),disabled:l(p).processing,onClick:M},{default:a(()=>e[17]||(e[17]=[d("Save")])),_:1,__:[17]},8,["class","disabled"])])]),_:1},8,["modelValue"]),t(x,{modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=s=>f.value=s),title:"Delete API Token","header-class":"bg-danger-subtle p-2","hide-footer":""},{default:a(()=>[e[20]||(e[20]=o("p",{class:"fs-14"},"Are you sure you would like to delete this API token?",-1)),o("div",ne,[t(u,{variant:"danger",class:"btn-sm",onClick:e[7]||(e[7]=s=>f.value=!f.value)},{default:a(()=>e[18]||(e[18]=[d("Cancel")])),_:1,__:[18]}),t(u,{variant:"success",class:A(["ms-1 btn-sm",{"opacity-25":l(B).processing}]),disabled:l(B).processing,onClick:N},{default:a(()=>e[19]||(e[19]=[d("Delete")])),_:1,__:[19]},8,["class","disabled"])])]),_:1,__:[20]},8,["modelValue"])])}}};export{ve as default};
